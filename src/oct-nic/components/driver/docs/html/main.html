<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Octeon PCI Driver: OCTEON PCI driver (OCTEON-PCI-BASE)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li id="current"><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<h1>OCTEON PCI driver (OCTEON-PCI-BASE)</h1>
<p>
<h3 align="center">2.2.0 </h3><b>NOTE:</b> The discussion in these pages pertain to OCTEON PCI base driver (OCTEON-PCI-BASE) Release 2.2.0. Please refer to the Release_notes.txt available at OCTEON-SDK/components/driver after installation of this package for what's new or changed in this release.<p>
<br>
<br>
 <h2><a class="anchor" name="sec0">
Introduction</a></h2>
OCTEON provides the following mechanisms for data transfer across PCI:<p>
<b>1. Input queues</b> - There are 4 Input queues in CN58xx OCTEON processors and 32 queues in CN56XX &amp; newer processors to which 32 or 64-byte instructions can be written by the PCI host. Based on the information in the instructions written by the host, OCTEON can without further assistance from host read data from host memory and create work queue entries that can be scheduled and processed on the OCTEON cores. More details about the implementation of Input queues can be found in the OCTEON Hardware manual.<p>
<b>2. Output queues</b> - There are 4 Output queues in CN58xx OCTEON processors and 32 queues in CN56XX &amp; newer processors. The queues use 16-byte descriptors that are filled with address of buffers in host memory by the PCI host. OCTEON transfers data packets scheduled by the OCTEON cores on PCI output ports to these host buffers. More details about the implementation of Output queues can be found in the OCTEON Hardware manual.<p>
<b>3. General purpose DMA engines</b> - OCTEON cores can directly transfer data between host memory and OCTEON L2/DRAM using DMA engines. There are 2 DMA engines in CN58xx, 5 in CN56xx and upto 6 in CN63xx &amp; CN68xx, though only 5 are available for general purpose DMA in CN63xx &amp; CN68xx if the Input/Output queues are also used. The cores submit PCI DMA instructions to the engines which then perform the required PCI operations to transfer the data. More details about the implementation of PCI DMA engines can be found in the OCTEON Hardware manual.<p>
The OCTEON PCI driver for linux (available as a rpm package - OCTEON-PCI-BASE) provides support for all the three mechanisms described above. The driver has components that work on the linux host and on the OCTEON cores.<p>
<br>
<br>
 OCTEON as a PCI device can function in two modes:<p>
<b>1. Packet Mode:</b> Packet mode is when the host and OCTEON send packets across the PCI bus. This mode is most useful when OCTEON is used as a NIC for carrying network traffic to and from the host.<p>
<b>2. Coprocessor Mode:</b> Coprocessor mode is when the host sends commands to OCTEON and waits for a response. This mode is used when OCTEON is performing offloads for the host system (E.g. IPsec encryption).<p>
The PCI driver provides support for linux kernel and user-space applications to communicate with OCTEON in both of these modes. Although the low-level mechanisms that accomplish this are very similar, the applications are quite different.<p>
The following additional packages are provided for OCTEON PCI that use the features provided by the base PCI driver and deliver added functionality:<p>
1. OCTEON-PCI-NIC: allows OCTEON to be used a NIC on linux host.<p>
2. OCTEON-PCI-CNTQ: provides additional software queues that use DMA engines.<p>
<br>
 <br>
 <b>NOTE:</b><p>
The documentation provided here discuss the features in the base PCI driver (OCTEON-PCI-BASE) only.<p>
<br>
 <br>
 <br>
 <h2><a class="anchor" name="sec1">
PCI Driver Components</a></h2>
The PCI driver package has two components. The first is a host driver available as a kernel module that performs the OCTEON device initialization, input and output queue management, interrupt handling and provides interfaces for user and kernel-space applications. In addition to the kernel module, the host components also includes several utilities that can be used to monitor the OCTEON queue statistics and to read/write OCTEON registers and memory. The host component also provides test applications that run in user-space and kernel-space. The test applications require a sample core application that is provided in the package.<p>
The second is a component which runs on the OCTEON cores. The core component is linked with the core application as a library and provides services to the application via API's. The RPM package also includes sample core applications. They can be found in OCTEON-SDK/applications/pci-core-app when the RPM package is installed. These applications demonstrate request/response (such as when OCTEON runs in co-processor mode), output queue packet transfer and PCI DMA operations and are a good place to start looking at how the API's provided by the core component of the PCI driver can be used in real-life applications.<p>
Further discussion on the PCI driver is split into the following sections:<p>
1.<a href="host-main.html">OCTEON Host PCI Driver component</a><p>
2.<a href="core-main.html">OCTEON Core PCI Driver component</a><p>
3.<a href="reqresp.html">Request processing using the OCTEON PCI driver</a><p>
4.<a href="oq-main.html">OCTEON Driver Output Operation </a><p>
5.<a href="util-main.html">OCTEON PCI Driver - Host Utilities </a><p>
6.<a href="test-main.html">OCTEON PCI Driver - Test programs </a><p>
<br>
<br>
 The directory structure of the sources for PCI driver and associated utilities can be found here: <a href="dir-main.html">OCTEON PCI driver source structure </a><p>
Compilation instructions can be found at OCTEON-SDK/components/driver/README.txt<p>
Select the links provided to the left to refer the source documentation. <hr size="1"><address style="align: right;"><small>Generated on Tue Nov 22 15:40:59 2011 for Octeon PCI Driver by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Octeon Common Component: cvm-common-queue.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>cvm-common-queue.h</h1><a href="cvm-common-queue_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/***********************************************************************</span>
00002 <span class="comment"></span>
00003 <span class="comment">  OCTEON TOOLKITS                                                         </span>
00004 <span class="comment">  Copyright (c) 2007 Cavium Networks. All rights reserved.</span>
00005 <span class="comment"></span>
00006 <span class="comment">  This file, which is part of the OCTEON TOOLKIT from Cavium Networks,</span>
00007 <span class="comment">  contains proprietary and confidential information of Cavium Networks</span>
00008 <span class="comment">  and in some cases its suppliers.</span>
00009 <span class="comment"></span>
00010 <span class="comment">  Any licensed reproduction, distribution, modification, or other use of</span>
00011 <span class="comment">  this file or confidential information embodied in this file is subject</span>
00012 <span class="comment">  to your license agreement with Cavium Networks. The applicable license</span>
00013 <span class="comment">  terms can be found by contacting Cavium Networks or the appropriate</span>
00014 <span class="comment">  representative within your company.</span>
00015 <span class="comment"></span>
00016 <span class="comment">  All other use and disclosure is prohibited.</span>
00017 <span class="comment"></span>
00018 <span class="comment">  Contact Cavium Networks at info@caviumnetworks.com for more information.</span>
00019 <span class="comment"></span>
00020 <span class="comment"> ************************************************************************/</span> 
00021 
00022 <span class="comment">/*</span>
00023 <span class="comment"> * Copyright (c) 1991, 1993</span>
00024 <span class="comment"> *  The Regents of the University of California.  All rights reserved.</span>
00025 <span class="comment"> *</span>
00026 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
00027 <span class="comment"> * modification, are permitted provided that the following conditions</span>
00028 <span class="comment"> * are met:</span>
00029 <span class="comment"> * 1. Redistributions of source code must retain the above copyright</span>
00030 <span class="comment"> *    notice, this list of conditions and the following disclaimer.</span>
00031 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span>
00032 <span class="comment"> *    notice, this list of conditions and the following disclaimer in the</span>
00033 <span class="comment"> *    documentation and/or other materials provided with the distribution.</span>
00034 <span class="comment"> * 4. Neither the name of the University nor the names of its contributors</span>
00035 <span class="comment"> *    may be used to endorse or promote products derived from this software</span>
00036 <span class="comment"> *    without specific prior written permission.</span>
00037 <span class="comment"> *</span>
00038 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND</span>
00039 <span class="comment"> * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
00040 <span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
00041 <span class="comment"> * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE</span>
00042 <span class="comment"> * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
00043 <span class="comment"> * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</span>
00044 <span class="comment"> * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
00045 <span class="comment"> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span>
00046 <span class="comment"> * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</span>
00047 <span class="comment"> * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</span>
00048 <span class="comment"> * SUCH DAMAGE.</span>
00049 <span class="comment"> *</span>
00050 <span class="comment"> *  @(#)queue.h 8.5 (Berkeley) 8/20/94</span>
00051 <span class="comment"> * $FreeBSD: src/sys/sys/queue.h,v 1.58 2004/04/07 04:19:49 imp Exp $</span>
00052 <span class="comment"> */</span>
00053 
00054 <span class="preprocessor">#ifndef __CVM_COMMON_QUEUE_H_</span>
00055 <span class="preprocessor"></span><span class="preprocessor">#define __CVM_COMMON_QUEUE_H_</span>
00056 <span class="preprocessor"></span>
00057 <span class="comment">/*</span>
00058 <span class="comment"> * This file defines four types of data structures: singly-linked lists,</span>
00059 <span class="comment"> * singly-linked tail queues, lists and tail queues.</span>
00060 <span class="comment"> *</span>
00061 <span class="comment"> * A singly-linked list is headed by a single forward pointer. The elements</span>
00062 <span class="comment"> * are singly linked for minimum space and pointer manipulation overhead at</span>
00063 <span class="comment"> * the expense of O(n) removal for arbitrary elements. New elements can be</span>
00064 <span class="comment"> * added to the list after an existing element or at the head of the list.</span>
00065 <span class="comment"> * Elements being removed from the head of the list should use the explicit</span>
00066 <span class="comment"> * macro for this purpose for optimum efficiency. A singly-linked list may</span>
00067 <span class="comment"> * only be traversed in the forward direction.  Singly-linked lists are ideal</span>
00068 <span class="comment"> * for applications with large datasets and few or no removals or for</span>
00069 <span class="comment"> * implementing a LIFO queue.</span>
00070 <span class="comment"> *</span>
00071 <span class="comment"> * A singly-linked tail queue is headed by a pair of pointers, one to the</span>
00072 <span class="comment"> * head of the list and the other to the tail of the list. The elements are</span>
00073 <span class="comment"> * singly linked for minimum space and pointer manipulation overhead at the</span>
00074 <span class="comment"> * expense of O(n) removal for arbitrary elements. New elements can be added</span>
00075 <span class="comment"> * to the list after an existing element, at the head of the list, or at the</span>
00076 <span class="comment"> * end of the list. Elements being removed from the head of the tail queue</span>
00077 <span class="comment"> * should use the explicit macro for this purpose for optimum efficiency.</span>
00078 <span class="comment"> * A singly-linked tail queue may only be traversed in the forward direction.</span>
00079 <span class="comment"> * Singly-linked tail queues are ideal for applications with large datasets</span>
00080 <span class="comment"> * and few or no removals or for implementing a FIFO queue.</span>
00081 <span class="comment"> *</span>
00082 <span class="comment"> * A list is headed by a single forward pointer (or an array of forward</span>
00083 <span class="comment"> * pointers for a hash table header). The elements are doubly linked</span>
00084 <span class="comment"> * so that an arbitrary element can be removed without a need to</span>
00085 <span class="comment"> * traverse the list. New elements can be added to the list before</span>
00086 <span class="comment"> * or after an existing element or at the head of the list. A list</span>
00087 <span class="comment"> * may only be traversed in the forward direction.</span>
00088 <span class="comment"> *</span>
00089 <span class="comment"> * A tail queue is headed by a pair of pointers, one to the head of the</span>
00090 <span class="comment"> * list and the other to the tail of the list. The elements are doubly</span>
00091 <span class="comment"> * linked so that an arbitrary element can be removed without a need to</span>
00092 <span class="comment"> * traverse the list. New elements can be added to the list before or</span>
00093 <span class="comment"> * after an existing element, at the head of the list, or at the end of</span>
00094 <span class="comment"> * the list. A tail queue may be traversed in either direction.</span>
00095 <span class="comment"> *</span>
00096 <span class="comment"> * For details on the use of these macros, see the queue(3) manual page.</span>
00097 <span class="comment"> *</span>
00098 <span class="comment"> *</span>
00099 <span class="comment"> *              SLIST   LIST    CVM_COMMON_STAILQ   CVM_COMMON_TAILQ</span>
00100 <span class="comment"> * _HEAD            +   +   +   +</span>
00101 <span class="comment"> * _HEAD_INITIALIZER        +   +   +   +</span>
00102 <span class="comment"> * _ENTRY           +   +   +   +</span>
00103 <span class="comment"> * _INIT            +   +   +   +</span>
00104 <span class="comment"> * _EMPTY           +   +   +   +</span>
00105 <span class="comment"> * _FIRST           +   +   +   +</span>
00106 <span class="comment"> * _NEXT            +   +   +   +</span>
00107 <span class="comment"> * _PREV            -   -   -   +</span>
00108 <span class="comment"> * _LAST            -   -   +   +</span>
00109 <span class="comment"> * _FOREACH         +   +   +   +</span>
00110 <span class="comment"> * _FOREACH_SAFE        +   +   +   +</span>
00111 <span class="comment"> * _FOREACH_REVERSE     -   -   -   +</span>
00112 <span class="comment"> * _FOREACH_REVERSE_SAFE    -   -   -   +</span>
00113 <span class="comment"> * _INSERT_HEAD         +   +   +   +</span>
00114 <span class="comment"> * _INSERT_BEFORE       -   +   -   +</span>
00115 <span class="comment"> * _INSERT_AFTER        +   +   +   +</span>
00116 <span class="comment"> * _INSERT_TAIL         -   -   +   +</span>
00117 <span class="comment"> * _CONCAT          -   -   +   +</span>
00118 <span class="comment"> * _REMOVE_HEAD         +   -   +   -</span>
00119 <span class="comment"> * _REMOVE          +   +   +   +</span>
00120 <span class="comment"> *</span>
00121 <span class="comment"> */</span>
<a name="l00122"></a><a class="code" href="cvm-common-queue_8h.html#a0">00122</a> <span class="preprocessor">#define CVM_COMMON_QUEUE_MACRO_DEBUG 0</span>
00123 <span class="preprocessor"></span><span class="preprocessor">#if CVM_COMMON_QUEUE_MACRO_DEBUG</span>
00124 <span class="preprocessor"></span><span class="comment">/* Store the last 2 places the queue element or head was altered */</span>
00125 <span class="keyword">struct </span>qm_trace {
00126     <span class="keywordtype">char</span> * lastfile;
00127     <span class="keywordtype">int</span> lastline;
00128     <span class="keywordtype">char</span> * prevfile;
00129     <span class="keywordtype">int</span> prevline;
00130 };
00131 
00132 <span class="preprocessor">#define CVM_COMMON_TRACEBUF struct qm_trace trace;</span>
00133 <span class="preprocessor"></span><span class="preprocessor">#define CVM_COMMON_TRASHIT(x)   do {(x) = (void *)-1;} while (0)</span>
00134 <span class="preprocessor"></span>
00135 <span class="preprocessor">#define CVM_COMMON_QMD_TRACE_HEAD(head) do {                \</span>
00136 <span class="preprocessor">    (head)-&gt;trace.prevline = (head)-&gt;trace.lastline;        \</span>
00137 <span class="preprocessor">    (head)-&gt;trace.prevfile = (head)-&gt;trace.lastfile;        \</span>
00138 <span class="preprocessor">    (head)-&gt;trace.lastline = __LINE__;              \</span>
00139 <span class="preprocessor">    (head)-&gt;trace.lastfile = __FILE__;              \</span>
00140 <span class="preprocessor">} while (0)</span>
00141 <span class="preprocessor"></span>
00142 <span class="preprocessor">#define QMD_TRACE_ELEM(elem) do {                   \</span>
00143 <span class="preprocessor">    (elem)-&gt;trace.prevline = (elem)-&gt;trace.lastline;        \</span>
00144 <span class="preprocessor">    (elem)-&gt;trace.prevfile = (elem)-&gt;trace.lastfile;        \</span>
00145 <span class="preprocessor">    (elem)-&gt;trace.lastline = __LINE__;              \</span>
00146 <span class="preprocessor">    (elem)-&gt;trace.lastfile = __FILE__;              \</span>
00147 <span class="preprocessor">} while (0)</span>
00148 <span class="preprocessor"></span>
00149 <span class="preprocessor">#else</span>
<a name="l00150"></a><a class="code" href="cvm-common-queue_8h.html#a1">00150</a> <span class="preprocessor"></span><span class="preprocessor">#define QMD_TRACE_ELEM(elem)</span>
<a name="l00151"></a><a class="code" href="cvm-common-queue_8h.html#a2">00151</a> <span class="preprocessor"></span><span class="preprocessor">#define CVM_COMMON_QMD_TRACE_HEAD(head)</span>
<a name="l00152"></a><a class="code" href="cvm-common-queue_8h.html#a3">00152</a> <span class="preprocessor"></span><span class="preprocessor">#define CVM_COMMON_TRACEBUF</span>
<a name="l00153"></a><a class="code" href="cvm-common-queue_8h.html#a4">00153</a> <span class="preprocessor"></span><span class="preprocessor">#define CVM_COMMON_TRASHIT(x)</span>
00154 <span class="preprocessor"></span><span class="preprocessor">#endif  </span><span class="comment">/* CVM_COMMON_QUEUE_MACRO_DEBUG */</span>
00155 
00156 <span class="comment">/*</span>
00157 <span class="comment"> * Singly-linked List declarations.</span>
00158 <span class="comment"> */</span>
<a name="l00159"></a><a class="code" href="cvm-common-queue_8h.html#a5">00159</a> <span class="preprocessor">#define CVM_COMMON_SLIST_HEAD(name, type)               \</span>
00160 <span class="preprocessor">struct name {                               \</span>
00161 <span class="preprocessor">    struct type *slh_first; </span><span class="comment">/* first element */</span>         \
00162 }
00163 
<a name="l00164"></a><a class="code" href="cvm-common-queue_8h.html#a6">00164</a> <span class="preprocessor">#define CVM_COMMON_SLIST_HEAD_INITIALIZER(head)             \</span>
00165 <span class="preprocessor">    { NULL }</span>
00166 <span class="preprocessor"></span>
<a name="l00167"></a><a class="code" href="cvm-common-queue_8h.html#a7">00167</a> <span class="preprocessor">#define CVM_COMMON_SLIST_ENTRY(type)                    \</span>
00168 <span class="preprocessor">struct {                                \</span>
00169 <span class="preprocessor">    struct type *sle_next;  </span><span class="comment">/* next element */</span>          \
00170 }
00171 
00172 <span class="comment">/*</span>
00173 <span class="comment"> * Singly-linked List functions.</span>
00174 <span class="comment"> */</span>
<a name="l00175"></a><a class="code" href="cvm-common-queue_8h.html#a8">00175</a> <span class="preprocessor">#define CVM_COMMON_SLIST_EMPTY(head)    ((head)-&gt;slh_first == NULL)</span>
00176 <span class="preprocessor"></span>
<a name="l00177"></a><a class="code" href="cvm-common-queue_8h.html#a9">00177</a> <span class="preprocessor">#define CVM_COMMON_SLIST_FIRST(head)    ((head)-&gt;slh_first)</span>
00178 <span class="preprocessor"></span>
<a name="l00179"></a><a class="code" href="cvm-common-queue_8h.html#a10">00179</a> <span class="preprocessor">#define CVM_COMMON_SLIST_FOREACH(var, head, field)          \</span>
00180 <span class="preprocessor">    for ((var) = CVM_COMMON_SLIST_FIRST((head));            \</span>
00181 <span class="preprocessor">        (var);                          \</span>
00182 <span class="preprocessor">        (var) = CVM_COMMON_SLIST_NEXT((var), field))</span>
00183 <span class="preprocessor"></span>
<a name="l00184"></a><a class="code" href="cvm-common-queue_8h.html#a11">00184</a> <span class="preprocessor">#define CVM_COMMON_SLIST_FOREACH_SAFE(var, head, field, tvar)       \</span>
00185 <span class="preprocessor">    for ((var) = CVM_COMMON_SLIST_FIRST((head));            \</span>
00186 <span class="preprocessor">        (var) &amp;&amp; ((tvar) = CVM_COMMON_SLIST_NEXT((var), field), 1); \</span>
00187 <span class="preprocessor">        (var) = (tvar))</span>
00188 <span class="preprocessor"></span>
<a name="l00189"></a><a class="code" href="cvm-common-queue_8h.html#a12">00189</a> <span class="preprocessor">#define CVM_COMMON_SLIST_FOREACH_PREVPTR(var, varp, head, field)    \</span>
00190 <span class="preprocessor">    for ((varp) = &amp;CVM_COMMON_SLIST_FIRST((head));          \</span>
00191 <span class="preprocessor">        ((var) = *(varp)) != NULL;                  \</span>
00192 <span class="preprocessor">        (varp) = &amp;CVM_COMMON_SLIST_NEXT((var), field))</span>
00193 <span class="preprocessor"></span>
<a name="l00194"></a><a class="code" href="cvm-common-queue_8h.html#a13">00194</a> <span class="preprocessor">#define CVM_COMMON_SLIST_INIT(head) do {                \</span>
00195 <span class="preprocessor">    CVM_COMMON_SLIST_FIRST((head)) = NULL;              \</span>
00196 <span class="preprocessor">} while (0)</span>
00197 <span class="preprocessor"></span>
<a name="l00198"></a><a class="code" href="cvm-common-queue_8h.html#a14">00198</a> <span class="preprocessor">#define CVM_COMMON_SLIST_INSERT_AFTER(slistelm, elm, field) do {    \</span>
00199 <span class="preprocessor">    CVM_COMMON_SLIST_NEXT((elm), field) = CVM_COMMON_SLIST_NEXT((slistelm), field); \</span>
00200 <span class="preprocessor">    CVM_COMMON_SLIST_NEXT((slistelm), field) = (elm);               \</span>
00201 <span class="preprocessor">} while (0)</span>
00202 <span class="preprocessor"></span>
<a name="l00203"></a><a class="code" href="cvm-common-queue_8h.html#a15">00203</a> <span class="preprocessor">#define CVM_COMMON_SLIST_INSERT_HEAD(head, elm, field) do {         \</span>
00204 <span class="preprocessor">    CVM_COMMON_SLIST_NEXT((elm), field) = CVM_COMMON_SLIST_FIRST((head));   \</span>
00205 <span class="preprocessor">    CVM_COMMON_SLIST_FIRST((head)) = (elm);                 \</span>
00206 <span class="preprocessor">} while (0)</span>
00207 <span class="preprocessor"></span>
<a name="l00208"></a><a class="code" href="cvm-common-queue_8h.html#a16">00208</a> <span class="preprocessor">#define CVM_COMMON_SLIST_NEXT(elm, field)   ((elm)-&gt;field.sle_next)</span>
00209 <span class="preprocessor"></span>
<a name="l00210"></a><a class="code" href="cvm-common-queue_8h.html#a17">00210</a> <span class="preprocessor">#define CVM_COMMON_SLIST_REMOVE(head, elm, type, field) do {        \</span>
00211 <span class="preprocessor">    if (CVM_COMMON_SLIST_FIRST((head)) == (elm)) {          \</span>
00212 <span class="preprocessor">        CVM_COMMON_SLIST_REMOVE_HEAD((head), field);        \</span>
00213 <span class="preprocessor">    }                               \</span>
00214 <span class="preprocessor">    else {                              \</span>
00215 <span class="preprocessor">        struct type *curelm = CVM_COMMON_SLIST_FIRST((head));   \</span>
00216 <span class="preprocessor">        while (CVM_COMMON_SLIST_NEXT(curelm, field) != (elm))   \</span>
00217 <span class="preprocessor">            curelm = CVM_COMMON_SLIST_NEXT(curelm, field);  \</span>
00218 <span class="preprocessor">        CVM_COMMON_SLIST_NEXT(curelm, field) =          \</span>
00219 <span class="preprocessor">            CVM_COMMON_SLIST_NEXT(CVM_COMMON_SLIST_NEXT(curelm, field), field); \</span>
00220 <span class="preprocessor">    }                               \</span>
00221 <span class="preprocessor">} while (0)</span>
00222 <span class="preprocessor"></span>
<a name="l00223"></a><a class="code" href="cvm-common-queue_8h.html#a18">00223</a> <span class="preprocessor">#define CVM_COMMON_SLIST_REMOVE_HEAD(head, field) do {          \</span>
00224 <span class="preprocessor">    CVM_COMMON_SLIST_FIRST((head)) = CVM_COMMON_SLIST_NEXT(CVM_COMMON_SLIST_FIRST((head)), field);  \</span>
00225 <span class="preprocessor">} while (0)</span>
00226 <span class="preprocessor"></span>
00227 <span class="comment">/*</span>
00228 <span class="comment"> * Singly-linked Tail queue declarations.</span>
00229 <span class="comment"> */</span>
<a name="l00230"></a><a class="code" href="cvm-common-queue_8h.html#a19">00230</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_HEAD(name, type)              \</span>
00231 <span class="preprocessor">struct name {                               \</span>
00232 <span class="preprocessor">    struct type *stqh_first;</span><span class="comment">/* first element */</span>         \
00233     struct type **stqh_last;<span class="comment">/* addr of last next element */</span>     \
00234 }
00235 
<a name="l00236"></a><a class="code" href="cvm-common-queue_8h.html#a20">00236</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_HEAD_INITIALIZER(head)            \</span>
00237 <span class="preprocessor">    { NULL, &amp;(head).stqh_first }</span>
00238 <span class="preprocessor"></span>
<a name="l00239"></a><a class="code" href="cvm-common-queue_8h.html#a21">00239</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_ENTRY(type)                   \</span>
00240 <span class="preprocessor">struct {                                \</span>
00241 <span class="preprocessor">    struct type *stqe_next; </span><span class="comment">/* next element */</span>          \
00242 }
00243 
00244 <span class="comment">/*</span>
00245 <span class="comment"> * Singly-linked Tail queue functions.</span>
00246 <span class="comment"> */</span>
<a name="l00247"></a><a class="code" href="cvm-common-queue_8h.html#a22">00247</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_CONCAT(head1, head2) do {         \</span>
00248 <span class="preprocessor">    if (!CVM_COMMON_STAILQ_EMPTY((head2))) {            \</span>
00249 <span class="preprocessor">        *(head1)-&gt;stqh_last = (head2)-&gt;stqh_first;      \</span>
00250 <span class="preprocessor">        (head1)-&gt;stqh_last = (head2)-&gt;stqh_last;        \</span>
00251 <span class="preprocessor">        CVM_COMMON_STAILQ_INIT((head2));            \</span>
00252 <span class="preprocessor">    }                               \</span>
00253 <span class="preprocessor">} while (0)</span>
00254 <span class="preprocessor"></span>
<a name="l00255"></a><a class="code" href="cvm-common-queue_8h.html#a23">00255</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_EMPTY(head)   ((head)-&gt;stqh_first == NULL)</span>
00256 <span class="preprocessor"></span>
<a name="l00257"></a><a class="code" href="cvm-common-queue_8h.html#a24">00257</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_FIRST(head)   ((head)-&gt;stqh_first)</span>
00258 <span class="preprocessor"></span>
<a name="l00259"></a><a class="code" href="cvm-common-queue_8h.html#a25">00259</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_FOREACH(var, head, field)         \</span>
00260 <span class="preprocessor">    for((var) = CVM_COMMON_STAILQ_FIRST((head));            \</span>
00261 <span class="preprocessor">       (var);                           \</span>
00262 <span class="preprocessor">       (var) = CVM_COMMON_STAILQ_NEXT((var), field))</span>
00263 <span class="preprocessor"></span>
00264 
<a name="l00265"></a><a class="code" href="cvm-common-queue_8h.html#a26">00265</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_FOREACH_SAFE(var, head, field, tvar)          \</span>
00266 <span class="preprocessor">    for ((var) = CVM_COMMON_STAILQ_FIRST((head));               \</span>
00267 <span class="preprocessor">        (var) &amp;&amp; ((tvar) = CVM_COMMON_STAILQ_NEXT((var), field), 1);    \</span>
00268 <span class="preprocessor">        (var) = (tvar))</span>
00269 <span class="preprocessor"></span>
<a name="l00270"></a><a class="code" href="cvm-common-queue_8h.html#a27">00270</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_INIT(head) do {                   \</span>
00271 <span class="preprocessor">    CVM_COMMON_STAILQ_FIRST((head)) = NULL;                 \</span>
00272 <span class="preprocessor">    (head)-&gt;stqh_last = &amp;CVM_COMMON_STAILQ_FIRST((head));           \</span>
00273 <span class="preprocessor">} while (0)</span>
00274 <span class="preprocessor"></span>
<a name="l00275"></a><a class="code" href="cvm-common-queue_8h.html#a28">00275</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_INSERT_AFTER(head, tqelm, elm, field) do {        \</span>
00276 <span class="preprocessor">    if ((CVM_COMMON_STAILQ_NEXT((elm), field) = CVM_COMMON_STAILQ_NEXT((tqelm), field)) == NULL)\</span>
00277 <span class="preprocessor">        (head)-&gt;stqh_last = &amp;CVM_COMMON_STAILQ_NEXT((elm), field);  \</span>
00278 <span class="preprocessor">    CVM_COMMON_STAILQ_NEXT((tqelm), field) = (elm);             \</span>
00279 <span class="preprocessor">} while (0)</span>
00280 <span class="preprocessor"></span>
<a name="l00281"></a><a class="code" href="cvm-common-queue_8h.html#a29">00281</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_INSERT_HEAD(head, elm, field) do {            \</span>
00282 <span class="preprocessor">    if ((CVM_COMMON_STAILQ_NEXT((elm), field) = CVM_COMMON_STAILQ_FIRST((head))) == NULL)   \</span>
00283 <span class="preprocessor">        (head)-&gt;stqh_last = &amp;CVM_COMMON_STAILQ_NEXT((elm), field);  \</span>
00284 <span class="preprocessor">    CVM_COMMON_STAILQ_FIRST((head)) = (elm);                \</span>
00285 <span class="preprocessor">} while (0)</span>
00286 <span class="preprocessor"></span>
<a name="l00287"></a><a class="code" href="cvm-common-queue_8h.html#a30">00287</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_INSERT_TAIL(head, elm, field) do {        \</span>
00288 <span class="preprocessor">    CVM_COMMON_STAILQ_NEXT((elm), field) = NULL;            \</span>
00289 <span class="preprocessor">    *(head)-&gt;stqh_last = (elm);                 \</span>
00290 <span class="preprocessor">    (head)-&gt;stqh_last = &amp;CVM_COMMON_STAILQ_NEXT((elm), field);  \</span>
00291 <span class="preprocessor">} while (0)</span>
00292 <span class="preprocessor"></span>
<a name="l00293"></a><a class="code" href="cvm-common-queue_8h.html#a31">00293</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_LAST(head, type, field)           \</span>
00294 <span class="preprocessor">    (CVM_COMMON_STAILQ_EMPTY((head)) ?              \</span>
00295 <span class="preprocessor">        NULL :                          \</span>
00296 <span class="preprocessor">            ((struct type *)                    \</span>
00297 <span class="preprocessor">        ((char *)((head)-&gt;stqh_last) - __offsetof(struct type, field))))</span>
00298 <span class="preprocessor"></span>
<a name="l00299"></a><a class="code" href="cvm-common-queue_8h.html#a32">00299</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_NEXT(elm, field)  ((elm)-&gt;field.stqe_next)</span>
00300 <span class="preprocessor"></span>
<a name="l00301"></a><a class="code" href="cvm-common-queue_8h.html#a33">00301</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_REMOVE(head, elm, type, field) do {       \</span>
00302 <span class="preprocessor">    if (CVM_COMMON_STAILQ_FIRST((head)) == (elm)) {         \</span>
00303 <span class="preprocessor">        CVM_COMMON_STAILQ_REMOVE_HEAD((head), field);       \</span>
00304 <span class="preprocessor">    }                               \</span>
00305 <span class="preprocessor">    else {                              \</span>
00306 <span class="preprocessor">        struct type *curelm = CVM_COMMON_STAILQ_FIRST((head));  \</span>
00307 <span class="preprocessor">        while (CVM_COMMON_STAILQ_NEXT(curelm, field) != (elm))  \</span>
00308 <span class="preprocessor">            curelm = CVM_COMMON_STAILQ_NEXT(curelm, field); \</span>
00309 <span class="preprocessor">        if ((CVM_COMMON_STAILQ_NEXT(curelm, field) =        \</span>
00310 <span class="preprocessor">             CVM_COMMON_STAILQ_NEXT(CVM_COMMON_STAILQ_NEXT(curelm, field), field)) == NULL)\</span>
00311 <span class="preprocessor">            (head)-&gt;stqh_last = &amp;CVM_COMMON_STAILQ_NEXT((curelm), field);\</span>
00312 <span class="preprocessor">    }                               \</span>
00313 <span class="preprocessor">} while (0)</span>
00314 <span class="preprocessor"></span>
<a name="l00315"></a><a class="code" href="cvm-common-queue_8h.html#a34">00315</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_REMOVE_HEAD(head, field) do {         \</span>
00316 <span class="preprocessor">    if ((CVM_COMMON_STAILQ_FIRST((head)) =              \</span>
00317 <span class="preprocessor">         CVM_COMMON_STAILQ_NEXT(CVM_COMMON_STAILQ_FIRST((head)), field)) == NULL)       \</span>
00318 <span class="preprocessor">        (head)-&gt;stqh_last = &amp;CVM_COMMON_STAILQ_FIRST((head));   \</span>
00319 <span class="preprocessor">} while (0)</span>
00320 <span class="preprocessor"></span>
<a name="l00321"></a><a class="code" href="cvm-common-queue_8h.html#a35">00321</a> <span class="preprocessor">#define CVM_COMMON_STAILQ_REMOVE_HEAD_UNTIL(head, elm, field) do {  \</span>
00322 <span class="preprocessor">    if ((CVM_COMMON_STAILQ_FIRST((head)) = CVM_COMMON_STAILQ_NEXT((elm), field)) == NULL)   \</span>
00323 <span class="preprocessor">        (head)-&gt;stqh_last = &amp;CVM_COMMON_STAILQ_FIRST((head));   \</span>
00324 <span class="preprocessor">} while (0)</span>
00325 <span class="preprocessor"></span>
00326 <span class="comment">/*</span>
00327 <span class="comment"> * List declarations.</span>
00328 <span class="comment"> */</span>
<a name="l00329"></a><a class="code" href="cvm-common-queue_8h.html#a36">00329</a> <span class="preprocessor">#define CVM_COMMON_LIST_HEAD(name, type)                \</span>
00330 <span class="preprocessor">struct name {                               \</span>
00331 <span class="preprocessor">    struct type *lh_first;  </span><span class="comment">/* first element */</span>         \
00332 }
00333 
<a name="l00334"></a><a class="code" href="cvm-common-queue_8h.html#a37">00334</a> <span class="preprocessor">#define CVM_COMMON_LIST_HEAD_INITIALIZER(head)              \</span>
00335 <span class="preprocessor">    { NULL }</span>
00336 <span class="preprocessor"></span>
<a name="l00337"></a><a class="code" href="cvm-common-queue_8h.html#a38">00337</a> <span class="preprocessor">#define CVM_COMMON_LIST_ENTRY(type)                 \</span>
00338 <span class="preprocessor">struct {                                \</span>
00339 <span class="preprocessor">    struct type *le_next;   </span><span class="comment">/* next element */</span>          \
00340     struct type **le_prev;  <span class="comment">/* address of previous next element */</span>  \
00341 }
00342 
00343 <span class="comment">/*</span>
00344 <span class="comment"> * List functions.</span>
00345 <span class="comment"> */</span>
00346 
<a name="l00347"></a><a class="code" href="cvm-common-queue_8h.html#a39">00347</a> <span class="preprocessor">#define CVM_COMMON_LIST_EMPTY(head) ((head)-&gt;lh_first == NULL)</span>
00348 <span class="preprocessor"></span>
<a name="l00349"></a><a class="code" href="cvm-common-queue_8h.html#a40">00349</a> <span class="preprocessor">#define CVM_COMMON_LIST_FIRST(head) ((head)-&gt;lh_first)</span>
00350 <span class="preprocessor"></span>
<a name="l00351"></a><a class="code" href="cvm-common-queue_8h.html#a41">00351</a> <span class="preprocessor">#define CVM_COMMON_LIST_FOREACH(var, head, field)           \</span>
00352 <span class="preprocessor">    for ((var) = CVM_COMMON_LIST_FIRST((head));         \</span>
00353 <span class="preprocessor">        (var);                          \</span>
00354 <span class="preprocessor">        (var) = CVM_COMMON_LIST_NEXT((var), field))</span>
00355 <span class="preprocessor"></span>
<a name="l00356"></a><a class="code" href="cvm-common-queue_8h.html#a42">00356</a> <span class="preprocessor">#define CVM_COMMON_LIST_FOREACH_SAFE(var, head, field, tvar)        \</span>
00357 <span class="preprocessor">    for ((var) = CVM_COMMON_LIST_FIRST((head));         \</span>
00358 <span class="preprocessor">        (var) &amp;&amp; ((tvar) = CVM_COMMON_LIST_NEXT((var), field), 1);  \</span>
00359 <span class="preprocessor">        (var) = (tvar))</span>
00360 <span class="preprocessor"></span>
<a name="l00361"></a><a class="code" href="cvm-common-queue_8h.html#a43">00361</a> <span class="preprocessor">#define CVM_COMMON_LIST_INIT(head) do {                 \</span>
00362 <span class="preprocessor">    CVM_COMMON_LIST_FIRST((head)) = NULL;               \</span>
00363 <span class="preprocessor">} while (0)</span>
00364 <span class="preprocessor"></span>
<a name="l00365"></a><a class="code" href="cvm-common-queue_8h.html#a44">00365</a> <span class="preprocessor">#define CVM_COMMON_LIST_INSERT_AFTER(listelm, elm, field) do {      \</span>
00366 <span class="preprocessor">    if ((CVM_COMMON_LIST_NEXT((elm), field) = CVM_COMMON_LIST_NEXT((listelm), field)) != NULL)\</span>
00367 <span class="preprocessor">        CVM_COMMON_LIST_NEXT((listelm), field)-&gt;field.le_prev =     \</span>
00368 <span class="preprocessor">            &amp;CVM_COMMON_LIST_NEXT((elm), field);            \</span>
00369 <span class="preprocessor">    CVM_COMMON_LIST_NEXT((listelm), field) = (elm);             \</span>
00370 <span class="preprocessor">    (elm)-&gt;field.le_prev = &amp;CVM_COMMON_LIST_NEXT((listelm), field);     \</span>
00371 <span class="preprocessor">} while (0)</span>
00372 <span class="preprocessor"></span>
<a name="l00373"></a><a class="code" href="cvm-common-queue_8h.html#a45">00373</a> <span class="preprocessor">#define CVM_COMMON_LIST_INSERT_BEFORE(listelm, elm, field) do {         \</span>
00374 <span class="preprocessor">    (elm)-&gt;field.le_prev = (listelm)-&gt;field.le_prev;            \</span>
00375 <span class="preprocessor">    CVM_COMMON_LIST_NEXT((elm), field) = (listelm);             \</span>
00376 <span class="preprocessor">    *(listelm)-&gt;field.le_prev = (elm);                  \</span>
00377 <span class="preprocessor">    (listelm)-&gt;field.le_prev = &amp;CVM_COMMON_LIST_NEXT((elm), field);     \</span>
00378 <span class="preprocessor">} while (0)</span>
00379 <span class="preprocessor"></span>
<a name="l00380"></a><a class="code" href="cvm-common-queue_8h.html#a46">00380</a> <span class="preprocessor">#define CVM_COMMON_LIST_INSERT_HEAD(head, elm, field) do {                  \</span>
00381 <span class="preprocessor">    if ((CVM_COMMON_LIST_NEXT((elm), field) = CVM_COMMON_LIST_FIRST((head))) != NULL)   \</span>
00382 <span class="preprocessor">        CVM_COMMON_LIST_FIRST((head))-&gt;field.le_prev = &amp;CVM_COMMON_LIST_NEXT((elm), field);\</span>
00383 <span class="preprocessor">    CVM_COMMON_LIST_FIRST((head)) = (elm);                  \</span>
00384 <span class="preprocessor">    (elm)-&gt;field.le_prev = &amp;CVM_COMMON_LIST_FIRST((head));          \</span>
00385 <span class="preprocessor">} while (0)</span>
00386 <span class="preprocessor"></span>
<a name="l00387"></a><a class="code" href="cvm-common-queue_8h.html#a47">00387</a> <span class="preprocessor">#define CVM_COMMON_LIST_NEXT(elm, field)    ((elm)-&gt;field.le_next)</span>
00388 <span class="preprocessor"></span>
<a name="l00389"></a><a class="code" href="cvm-common-queue_8h.html#a48">00389</a> <span class="preprocessor">#define CVM_COMMON_LIST_REMOVE(elm, field) do {             \</span>
00390 <span class="preprocessor">    if (CVM_COMMON_LIST_NEXT((elm), field) != NULL)         \</span>
00391 <span class="preprocessor">        CVM_COMMON_LIST_NEXT((elm), field)-&gt;field.le_prev =     \</span>
00392 <span class="preprocessor">            (elm)-&gt;field.le_prev;               \</span>
00393 <span class="preprocessor">    *(elm)-&gt;field.le_prev = CVM_COMMON_LIST_NEXT((elm), field); \</span>
00394 <span class="preprocessor">} while (0)</span>
00395 <span class="preprocessor"></span>
00396 <span class="comment">/*</span>
00397 <span class="comment"> * Tail queue declarations.</span>
00398 <span class="comment"> */</span>
<a name="l00399"></a><a class="code" href="cvm-common-queue_8h.html#a49">00399</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_HEAD(name, type)               \</span>
00400 <span class="preprocessor">struct name {                               \</span>
00401 <span class="preprocessor">    struct type *tqh_first; </span><span class="comment">/* first element */</span>         \
00402     struct type **tqh_last; <span class="comment">/* addr of last next element */</span>     \
00403     CVM_COMMON_TRACEBUF                     \
00404 }
00405 
<a name="l00406"></a><a class="code" href="cvm-common-queue_8h.html#a50">00406</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_HEAD_INITIALIZER(head)             \</span>
00407 <span class="preprocessor">    { NULL, &amp;(head).tqh_first }</span>
00408 <span class="preprocessor"></span>
<a name="l00409"></a><a class="code" href="cvm-common-queue_8h.html#a51">00409</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_ENTRY(type)                    \</span>
00410 <span class="preprocessor">struct {                                \</span>
00411 <span class="preprocessor">    struct type *tqe_next;  </span><span class="comment">/* next element */</span>          \
00412     struct type **tqe_prev; <span class="comment">/* address of previous next element */</span>  \
00413     CVM_COMMON_TRACEBUF                     \
00414 }
00415 
00416 <span class="comment">/*</span>
00417 <span class="comment"> * Tail queue functions.</span>
00418 <span class="comment"> */</span>
<a name="l00419"></a><a class="code" href="cvm-common-queue_8h.html#a52">00419</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_CONCAT(head1, head2, field) do {       \</span>
00420 <span class="preprocessor">    if (!CVM_COMMON_TAILQ_EMPTY(head2)) {               \</span>
00421 <span class="preprocessor">        *(head1)-&gt;tqh_last = (head2)-&gt;tqh_first;        \</span>
00422 <span class="preprocessor">        (head2)-&gt;tqh_first-&gt;field.tqe_prev = (head1)-&gt;tqh_last; \</span>
00423 <span class="preprocessor">        (head1)-&gt;tqh_last = (head2)-&gt;tqh_last;          \</span>
00424 <span class="preprocessor">        CVM_COMMON_TAILQ_INIT((head2));             \</span>
00425 <span class="preprocessor">        CVM_COMMON_QMD_TRACE_HEAD(head);            \</span>
00426 <span class="preprocessor">        CVM_COMMON_QMD_TRACE_HEAD(head2);           \</span>
00427 <span class="preprocessor">    }                               \</span>
00428 <span class="preprocessor">} while (0)</span>
00429 <span class="preprocessor"></span>
<a name="l00430"></a><a class="code" href="cvm-common-queue_8h.html#a53">00430</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_EMPTY(head)    ((head)-&gt;tqh_first == NULL)</span>
00431 <span class="preprocessor"></span>
<a name="l00432"></a><a class="code" href="cvm-common-queue_8h.html#a54">00432</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_FIRST(head)    ((head)-&gt;tqh_first)</span>
00433 <span class="preprocessor"></span>
<a name="l00434"></a><a class="code" href="cvm-common-queue_8h.html#a55">00434</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_FOREACH(var, head, field)          \</span>
00435 <span class="preprocessor">    for ((var) = CVM_COMMON_TAILQ_FIRST((head));            \</span>
00436 <span class="preprocessor">        (var);                          \</span>
00437 <span class="preprocessor">        (var) = CVM_COMMON_TAILQ_NEXT((var), field))</span>
00438 <span class="preprocessor"></span>
<a name="l00439"></a><a class="code" href="cvm-common-queue_8h.html#a56">00439</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_FOREACH_SAFE(var, head, field, tvar)       \</span>
00440 <span class="preprocessor">    for ((var) = CVM_COMMON_TAILQ_FIRST((head));            \</span>
00441 <span class="preprocessor">        (var) &amp;&amp; ((tvar) = CVM_COMMON_TAILQ_NEXT((var), field), 1); \</span>
00442 <span class="preprocessor">        (var) = (tvar))</span>
00443 <span class="preprocessor"></span>
<a name="l00444"></a><a class="code" href="cvm-common-queue_8h.html#a57">00444</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_FOREACH_REVERSE(var, head, headname, field)    \</span>
00445 <span class="preprocessor">    for ((var) = CVM_COMMON_TAILQ_LAST((head), headname);       \</span>
00446 <span class="preprocessor">        (var);                          \</span>
00447 <span class="preprocessor">        (var) = CVM_COMMON_TAILQ_PREV((var), headname, field))</span>
00448 <span class="preprocessor"></span>
<a name="l00449"></a><a class="code" href="cvm-common-queue_8h.html#a58">00449</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_FOREACH_REVERSE_SAFE(var, head, headname, field, tvar) \</span>
00450 <span class="preprocessor">    for ((var) = CVM_COMMON_TAILQ_LAST((head), headname);           \</span>
00451 <span class="preprocessor">        (var) &amp;&amp; ((tvar) = CVM_COMMON_TAILQ_PREV((var), headname, field), 1);   \</span>
00452 <span class="preprocessor">        (var) = (tvar))</span>
00453 <span class="preprocessor"></span>
<a name="l00454"></a><a class="code" href="cvm-common-queue_8h.html#a59">00454</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_INIT(head) do {                    \</span>
00455 <span class="preprocessor">    CVM_COMMON_TAILQ_FIRST((head)) = NULL;                  \</span>
00456 <span class="preprocessor">    (head)-&gt;tqh_last = &amp;CVM_COMMON_TAILQ_FIRST((head));         \</span>
00457 <span class="preprocessor">    CVM_COMMON_QMD_TRACE_HEAD(head);                    \</span>
00458 <span class="preprocessor">} while (0)</span>
00459 <span class="preprocessor"></span>
<a name="l00460"></a><a class="code" href="cvm-common-queue_8h.html#a60">00460</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_INSERT_AFTER(head, listelm, elm, field) do {       \</span>
00461 <span class="preprocessor">    if ((CVM_COMMON_TAILQ_NEXT((elm), field) = CVM_COMMON_TAILQ_NEXT((listelm), field)) != NULL)\</span>
00462 <span class="preprocessor">        CVM_COMMON_TAILQ_NEXT((elm), field)-&gt;field.tqe_prev =       \</span>
00463 <span class="preprocessor">            &amp;CVM_COMMON_TAILQ_NEXT((elm), field);           \</span>
00464 <span class="preprocessor">    else {                                  \</span>
00465 <span class="preprocessor">        (head)-&gt;tqh_last = &amp;CVM_COMMON_TAILQ_NEXT((elm), field);    \</span>
00466 <span class="preprocessor">        CVM_COMMON_QMD_TRACE_HEAD(head);                \</span>
00467 <span class="preprocessor">    }                                   \</span>
00468 <span class="preprocessor">    CVM_COMMON_TAILQ_NEXT((listelm), field) = (elm);            \</span>
00469 <span class="preprocessor">    (elm)-&gt;field.tqe_prev = &amp;CVM_COMMON_TAILQ_NEXT((listelm), field);   \</span>
00470 <span class="preprocessor">    QMD_TRACE_ELEM(&amp;(elm)-&gt;field);                      \</span>
00471 <span class="preprocessor">    QMD_TRACE_ELEM(&amp;listelm-&gt;field);                    \</span>
00472 <span class="preprocessor">} while (0)</span>
00473 <span class="preprocessor"></span>
<a name="l00474"></a><a class="code" href="cvm-common-queue_8h.html#a61">00474</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_INSERT_BEFORE(listelm, elm, field) do {        \</span>
00475 <span class="preprocessor">    (elm)-&gt;field.tqe_prev = (listelm)-&gt;field.tqe_prev;          \</span>
00476 <span class="preprocessor">    CVM_COMMON_TAILQ_NEXT((elm), field) = (listelm);            \</span>
00477 <span class="preprocessor">    *(listelm)-&gt;field.tqe_prev = (elm);                 \</span>
00478 <span class="preprocessor">    (listelm)-&gt;field.tqe_prev = &amp;CVM_COMMON_TAILQ_NEXT((elm), field);   \</span>
00479 <span class="preprocessor">    QMD_TRACE_ELEM(&amp;(elm)-&gt;field);                      \</span>
00480 <span class="preprocessor">    QMD_TRACE_ELEM(&amp;listelm-&gt;field);                    \</span>
00481 <span class="preprocessor">} while (0)</span>
00482 <span class="preprocessor"></span>
<a name="l00483"></a><a class="code" href="cvm-common-queue_8h.html#a62">00483</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_INSERT_HEAD(head, elm, field) do {         \</span>
00484 <span class="preprocessor">    if ((CVM_COMMON_TAILQ_NEXT((elm), field) = CVM_COMMON_TAILQ_FIRST((head))) != NULL) \</span>
00485 <span class="preprocessor">        CVM_COMMON_TAILQ_FIRST((head))-&gt;field.tqe_prev =        \</span>
00486 <span class="preprocessor">            &amp;CVM_COMMON_TAILQ_NEXT((elm), field);           \</span>
00487 <span class="preprocessor">    else                                    \</span>
00488 <span class="preprocessor">        (head)-&gt;tqh_last = &amp;CVM_COMMON_TAILQ_NEXT((elm), field);    \</span>
00489 <span class="preprocessor">    CVM_COMMON_TAILQ_FIRST((head)) = (elm);                 \</span>
00490 <span class="preprocessor">    (elm)-&gt;field.tqe_prev = &amp;CVM_COMMON_TAILQ_FIRST((head));        \</span>
00491 <span class="preprocessor">    CVM_COMMON_QMD_TRACE_HEAD(head);                    \</span>
00492 <span class="preprocessor">    QMD_TRACE_ELEM(&amp;(elm)-&gt;field);                      \</span>
00493 <span class="preprocessor">} while (0)</span>
00494 <span class="preprocessor"></span>
<a name="l00495"></a><a class="code" href="cvm-common-queue_8h.html#a63">00495</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_INSERT_TAIL(head, elm, field) do {         \</span>
00496 <span class="preprocessor">    CVM_COMMON_TAILQ_NEXT((elm), field) = NULL;             \</span>
00497 <span class="preprocessor">    (elm)-&gt;field.tqe_prev = (head)-&gt;tqh_last;               \</span>
00498 <span class="preprocessor">    *(head)-&gt;tqh_last = (elm);                      \</span>
00499 <span class="preprocessor">    (head)-&gt;tqh_last = &amp;CVM_COMMON_TAILQ_NEXT((elm), field);        \</span>
00500 <span class="preprocessor">    CVM_COMMON_QMD_TRACE_HEAD(head);                    \</span>
00501 <span class="preprocessor">    QMD_TRACE_ELEM(&amp;(elm)-&gt;field);                      \</span>
00502 <span class="preprocessor">} while (0)</span>
00503 <span class="preprocessor"></span>
<a name="l00504"></a><a class="code" href="cvm-common-queue_8h.html#a64">00504</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_LAST(head, headname)                   \</span>
00505 <span class="preprocessor">    (*(((struct headname *)((head)-&gt;tqh_last))-&gt;tqh_last))</span>
00506 <span class="preprocessor"></span>
<a name="l00507"></a><a class="code" href="cvm-common-queue_8h.html#a65">00507</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_NEXT(elm, field) ((elm)-&gt;field.tqe_next)</span>
00508 <span class="preprocessor"></span>
<a name="l00509"></a><a class="code" href="cvm-common-queue_8h.html#a66">00509</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_PREV(elm, headname, field)             \</span>
00510 <span class="preprocessor">    (*(((struct headname *)((elm)-&gt;field.tqe_prev))-&gt;tqh_last))</span>
00511 <span class="preprocessor"></span>
<a name="l00512"></a><a class="code" href="cvm-common-queue_8h.html#a67">00512</a> <span class="preprocessor">#define CVM_COMMON_TAILQ_REMOVE(head, elm, field) do {              \</span>
00513 <span class="preprocessor">    if ((CVM_COMMON_TAILQ_NEXT((elm), field)) != NULL)          \</span>
00514 <span class="preprocessor">        CVM_COMMON_TAILQ_NEXT((elm), field)-&gt;field.tqe_prev =       \</span>
00515 <span class="preprocessor">            (elm)-&gt;field.tqe_prev;                  \</span>
00516 <span class="preprocessor">    else {                                  \</span>
00517 <span class="preprocessor">        (head)-&gt;tqh_last = (elm)-&gt;field.tqe_prev;           \</span>
00518 <span class="preprocessor">        CVM_COMMON_QMD_TRACE_HEAD(head);                \</span>
00519 <span class="preprocessor">    }                                   \</span>
00520 <span class="preprocessor">    *(elm)-&gt;field.tqe_prev = CVM_COMMON_TAILQ_NEXT((elm), field);       \</span>
00521 <span class="preprocessor">    CVM_COMMON_TRASHIT((elm)-&gt;field.tqe_next);              \</span>
00522 <span class="preprocessor">    CVM_COMMON_TRASHIT((elm)-&gt;field.tqe_prev);              \</span>
00523 <span class="preprocessor">    QMD_TRACE_ELEM(&amp;(elm)-&gt;field);                      \</span>
00524 <span class="preprocessor">} while (0)</span>
00525 <span class="preprocessor"></span>
00526 <span class="preprocessor">#endif </span><span class="comment">/* !__CVM_COMMON_QUEUE_H_ */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Oct 25 14:15:48 2011 for Octeon Common Component by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Octeon Common Component: cvm-common-wqe.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>cvm-common-wqe.h</h1><a href="cvm-common-wqe_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/***********************************************************************</span>
00002 <span class="comment"></span>
00003 <span class="comment">  OCTEON TOOLKITS                                                         </span>
00004 <span class="comment">  Copyright (c) 2007 Cavium Networks. All rights reserved.</span>
00005 <span class="comment"></span>
00006 <span class="comment">  This file, which is part of the OCTEON TOOLKIT from Cavium Networks,</span>
00007 <span class="comment">  contains proprietary and confidential information of Cavium Networks</span>
00008 <span class="comment">  and in some cases its suppliers.</span>
00009 <span class="comment"></span>
00010 <span class="comment">  Any licensed reproduction, distribution, modification, or other use of</span>
00011 <span class="comment">  this file or confidential information embodied in this file is subject</span>
00012 <span class="comment">  to your license agreement with Cavium Networks. The applicable license</span>
00013 <span class="comment">  terms can be found by contacting Cavium Networks or the appropriate</span>
00014 <span class="comment">  representative within your company.</span>
00015 <span class="comment"></span>
00016 <span class="comment">  All other use and disclosure is prohibited.</span>
00017 <span class="comment"></span>
00018 <span class="comment">  Contact Cavium Networks at info@caviumnetworks.com for more information.</span>
00019 <span class="comment"></span>
00020 <span class="comment"> ************************************************************************/</span> 
00021 
00022 <span class="preprocessor">#ifndef __CVM_COMMON_WQE_H__</span>
00023 <span class="preprocessor"></span><span class="preprocessor">#define __CVM_COMMON_WQE_H__</span>
00024 <span class="preprocessor"></span>
00025 
00026 <span class="comment">/*</span>
00027 <span class="comment"> * Software work queue entry</span>
00028 <span class="comment"> */</span>
00029 <span class="keyword">struct </span>cvm_tcp_tcpcb;
00030 <span class="keyword">struct </span>cvm_ip_ifaddr;
00031 
00032 <span class="preprocessor">#ifdef WORK_QUEUE_ENTRY_SIZE_128 // {</span>
00033 <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keyword">struct</span>
00034 <span class="keyword"></span>{
00035     cvmx_wqe_word0_t        word0;
00036 
00037     cvmx_wqe_word1_t        word1;
00038 
00039     cvmx_pip_wqe_word2_t    word2;
00040 <span class="comment"></span>
00041 <span class="comment">    /**</span>
00042 <span class="comment">     * Field access macros</span>
00043 <span class="comment">     */</span>
00044 <span class="preprocessor">#define wqe_w1_tag       word1.cn68xx.tag</span>
00045 <span class="preprocessor"></span><span class="preprocessor">#define wqe_w1_tag_type  word1.cn68xx.tag_type</span>
00046 <span class="preprocessor"></span><span class="preprocessor">#define wqe_w1_len       word1.len</span>
00047 <span class="preprocessor"></span>
00048 <span class="comment"></span>
00049 <span class="comment">    /**</span>
00050 <span class="comment">     * Pointer to the first segment of the packet.</span>
00051 <span class="comment">     */</span>
00052     cvmx_buf_ptr_t             packet_ptr;
00053 
00054 
00055     uint8_t packet_data[96 - 32];
00056 
00057 } cvm_common_hw_wqe_t;
00058 
00059 
00060 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcvm__common__wqe.html">cvm_common_wqe</a> {
00061     cvm_common_hw_wqe_t <a class="code" href="structcvm__common__wqe.html#o0">hw_wqe</a>;   <span class="comment">/* 128-48 bytes from hardware */</span>
00062 <span class="preprocessor">#else</span>
00063 <span class="preprocessor"></span>
<a name="l00064"></a><a class="code" href="structcvm__common__wqe.html">00064</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcvm__common__wqe.html">cvm_common_wqe</a> {
<a name="l00065"></a><a class="code" href="structcvm__common__wqe.html#o0">00065</a>     cvmx_wqe_t <a class="code" href="structcvm__common__wqe.html#o0">hw_wqe</a>;   <span class="comment">/* 128 bytes from hardware */</span>
00066 
00067 <span class="preprocessor">#endif // WORK_QUEUE_ENTRY_SIZE_128 }</span>
00068 <span class="preprocessor"></span><span class="comment"></span>
00069 <span class="comment">    /**</span>
00070 <span class="comment">     * Field access macros</span>
00071 <span class="comment">     */</span>
<a name="l00072"></a><a class="code" href="cvm-common-wqe_8h.html#a0">00072</a> <span class="preprocessor">#define hwqe_w1_tag       hw_wqe.word1.cn68xx.tag</span>
<a name="l00073"></a><a class="code" href="cvm-common-wqe_8h.html#a1">00073</a> <span class="preprocessor"></span><span class="preprocessor">#define hwqe_w1_tag_type  hw_wqe.word1.cn68xx.tag_type</span>
<a name="l00074"></a><a class="code" href="cvm-common-wqe_8h.html#a2">00074</a> <span class="preprocessor"></span><span class="preprocessor">#define hwqe_w1_len       hw_wqe.word1.len</span>
00075 <span class="preprocessor"></span>
00076     <span class="comment">/* Software usable space */</span>
<a name="l00077"></a><a class="code" href="structcvm__common__wqe.html#o1">00077</a>     <span class="keyword">struct </span><a class="code" href="structcvm__common__wqe.html">cvm_common_wqe</a>   *<a class="code" href="structcvm__common__wqe.html#o1">next</a>;
<a name="l00078"></a><a class="code" href="structcvm__common__wqe.html#o2">00078</a>     <span class="keyword">struct </span>cvm_ip_ifaddr    *<a class="code" href="structcvm__common__wqe.html#o2">ifa</a>;   <span class="comment">/* IP address */</span>
<a name="l00079"></a><a class="code" href="structcvm__common__wqe.html#o3">00079</a>     <span class="keyword">struct </span>cvm_tcp_tcpcb    *<a class="code" href="structcvm__common__wqe.html#o3">tcb</a>;   <span class="comment">/* TCP Connection Block */</span>
<a name="l00080"></a><a class="code" href="structcvm__common__wqe.html#o4">00080</a>     uint32_t    <a class="code" href="structcvm__common__wqe.html#o4">ifidx</a>;          <span class="comment">/* Interface index */</span>
<a name="l00081"></a><a class="code" href="structcvm__common__wqe.html#o5">00081</a>     uint8_t <a class="code" href="structcvm__common__wqe.html#o5">l4_offset</a>;      <span class="comment">/* Offset of L4 header */</span>
<a name="l00082"></a><a class="code" href="structcvm__common__wqe.html#o6">00082</a>     uint8_t <a class="code" href="structcvm__common__wqe.html#o6">l4_prot</a>;        <span class="comment">/* L4 protocol */</span>
<a name="l00083"></a><a class="code" href="structcvm__common__wqe.html#o7">00083</a>     uint8_t <a class="code" href="structcvm__common__wqe.html#o7">opprt</a>;          <span class="comment">/* Output port for this entry */</span>
00084     <span class="keyword">struct </span>{
<a name="l00085"></a><a class="code" href="structcvm__common__wqe.html#o8">00085</a>         uint8_t <a class="code" href="structcvm__common__wqe.html#o8">sc</a>            : 1;    <span class="comment">/* set if lookup yields syncache entry */</span>
<a name="l00086"></a><a class="code" href="structcvm__common__wqe.html#o9">00086</a>         uint8_t <a class="code" href="structcvm__common__wqe.html#o9">gth</a>           : 1;    <span class="comment">/* set if ptr indicates a gather list */</span>
<a name="l00087"></a><a class="code" href="structcvm__common__wqe.html#o10">00087</a>         uint8_t <a class="code" href="structcvm__common__wqe.html#o10">no_tag_switch</a> : 1;    <span class="comment">/* tells PKO routine not to tag switch</span>
00088 <span class="comment">                                         before sending a packet */</span>
<a name="l00089"></a><a class="code" href="structcvm__common__wqe.html#o11">00089</a>         uint8_t <a class="code" href="structcvm__common__wqe.html#o11">mc</a>            : 1;    <span class="comment">/* tells if packet is multicast */</span>
<a name="l00090"></a><a class="code" href="structcvm__common__wqe.html#o12">00090</a>         uint8_t <a class="code" href="structcvm__common__wqe.html#o12">listen_lookup</a> : 1;    <span class="comment">/* tells if listen lookup has been done */</span>
<a name="l00091"></a><a class="code" href="structcvm__common__wqe.html#o13">00091</a>         uint8_t <a class="code" href="structcvm__common__wqe.html#o13">reserved</a>      : 3;    <span class="comment">/* Reserved */</span>
00092     } <a class="code" href="structcvm__common__wqe.html#o14">control</a>;           <span class="comment">/* processing control bits */</span>    
00093 <span class="preprocessor">#ifdef CVMX_ABI_N32</span>
00094 <span class="preprocessor"></span>    uint32_t reserved2[2];
00095 <span class="preprocessor">#endif</span>
00096 <span class="preprocessor"></span>
00097 <span class="preprocessor">#ifndef WORK_QUEUE_ENTRY_SIZE_128 // {</span>
<a name="l00098"></a><a class="code" href="structcvm__common__wqe.html#o15">00098</a> <span class="preprocessor"></span>    uint64_t    <a class="code" href="structcvm__common__wqe.html#o13">reserved</a>[16 - 4];
00099 <span class="preprocessor">#endif</span>
00100 <span class="preprocessor"></span>} <a class="code" href="structcvm__common__wqe.html">cvm_common_wqe_t</a>;
00101 
00102 
00103 
00104 <span class="comment">/*</span>
00105 <span class="comment"> * Wrapper functions to access WQE fields with offsets/legths </span>
00106 <span class="comment"> * varying between OCTEON models.</span>
00107 <span class="comment"> */</span>
00108 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00109"></a><a class="code" href="cvm-common-wqe_8h.html#a4">00109</a> <a class="code" href="cvm-common-wqe_8h.html#a4">cvm_common_wqe_get_port</a>(<a class="code" href="structcvm__common__wqe.html">cvm_common_wqe_t</a> *wqe)
00110 {
00111     <span class="keywordflow">return</span> cvmx_wqe_get_port((cvmx_wqe_t *)wqe);
00112 }
00113 
00114 
00115 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00116"></a><a class="code" href="cvm-common-wqe_8h.html#a5">00116</a> <a class="code" href="cvm-common-wqe_8h.html#a5">cvm_common_wqe_set_port</a>(<a class="code" href="structcvm__common__wqe.html">cvm_common_wqe_t</a> *wqe, <span class="keywordtype">int</span> port)
00117 {
00118     cvmx_wqe_set_port((cvmx_wqe_t *)wqe, port);
00119 }
00120 
00121 
00122 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00123"></a><a class="code" href="cvm-common-wqe_8h.html#a6">00123</a> <a class="code" href="cvm-common-wqe_8h.html#a6">cvm_common_wqe_get_grp</a>(<a class="code" href="structcvm__common__wqe.html">cvm_common_wqe_t</a> *wqe)
00124 {
00125     <span class="keywordflow">return</span> cvmx_wqe_get_grp((cvmx_wqe_t *)wqe);
00126 }
00127 
00128 
00129 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00130"></a><a class="code" href="cvm-common-wqe_8h.html#a7">00130</a> <a class="code" href="cvm-common-wqe_8h.html#a7">cvm_common_wqe_set_grp</a>(<a class="code" href="structcvm__common__wqe.html">cvm_common_wqe_t</a> *wqe, <span class="keywordtype">int</span> grp)
00131 {
00132     cvmx_wqe_set_grp((cvmx_wqe_t *)wqe, grp);
00133 }
00134 
00135 
00136 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00137"></a><a class="code" href="cvm-common-wqe_8h.html#a8">00137</a> <a class="code" href="cvm-common-wqe_8h.html#a8">cvm_common_wqe_get_qos</a>(<a class="code" href="structcvm__common__wqe.html">cvm_common_wqe_t</a> *wqe)
00138 {
00139     <span class="keywordflow">return</span> cvmx_wqe_get_qos((cvmx_wqe_t *)wqe);
00140 }
00141 
00142 
00143 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00144"></a><a class="code" href="cvm-common-wqe_8h.html#a9">00144</a> <a class="code" href="cvm-common-wqe_8h.html#a9">cvm_common_wqe_set_qos</a>(<a class="code" href="structcvm__common__wqe.html">cvm_common_wqe_t</a> *wqe, <span class="keywordtype">int</span> qos)
00145 {
00146     cvmx_wqe_set_qos((cvmx_wqe_t *)wqe, qos);
00147 }
00148 
00149 
00150 
00151 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00152"></a><a class="code" href="cvm-common-wqe_8h.html#a10">00152</a> <a class="code" href="cvm-common-wqe_8h.html#a10">cvm_common_wqe_get_unused</a>(<a class="code" href="structcvm__common__wqe.html">cvm_common_wqe_t</a> *wqe)
00153 {
00154     <span class="keywordflow">return</span> cvmx_wqe_get_unused8((cvmx_wqe_t *)wqe);
00155 }
00156 
00157 
00158 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00159"></a><a class="code" href="cvm-common-wqe_8h.html#a11">00159</a> <a class="code" href="cvm-common-wqe_8h.html#a11">cvm_common_wqe_set_unused</a>(<a class="code" href="structcvm__common__wqe.html">cvm_common_wqe_t</a> *wqe, <span class="keywordtype">int</span> v)
00160 {
00161     cvmx_wqe_set_unused8((cvmx_wqe_t *)wqe, v);
00162 }
00163 
00164 
00165 <span class="preprocessor">#endif </span><span class="comment">/* _CVM_COMMON_INLINE_H__ */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Oct 25 14:15:48 2011 for Octeon Common Component by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
